<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		body {
			font-family: Verdana, "sans-serif";
		}
		table.league-table, table.results {
			border-collapse: collapse;
			background: #E6E6E6;
			font-size: 0.7em;
		}
		table.league-table td, table.league-table th, table.results td {
			border: solid white 0.2em;
			padding: 0.6em 1em;
		}
		table.league-table th {
			background: #191919;
			color: #FFFFFF;
			font-weight: normal;
		}
		table.league-table td.centered {
			text-align: center;
		}

		table.results td[class^=team-] {
			width: 10em;
		}
		table.results td.team-a {
			text-align: right;
		}

		.arrow-up {
			display: inline-block;
			margin-top: 0.3em;
			margin-left: 0.5em;
			width: 0; 
			height: 0; 
			border-left: 0.4em solid transparent;
			border-right: 0.4em solid transparent;
			border-bottom: calc((0.4em + 0.4em) * 0.866) solid green;
		}
		.arrow-down {
			display: inline-block;
			margin-top: 0.3em;
			margin-left: 0.5em;
			width: 0; 
			height: 0; 
			border-left: 0.4em solid transparent;
			border-right: 0.4em solid transparent;
			border-top: calc((0.4em + 0.4em) * 0.866) solid red;
		}
	</style>

	<script src="https://npmcdn.com/react@15.3.0/dist/react.js"></script>
	<script src="https://npmcdn.com/react-dom@15.3.0/dist/react-dom.js"></script>
	<script src="https://npmcdn.com/babel-core@5.8.38/browser.min.js"></script>
	<script src="jquery/dist/jquery.js" type="text/javascript"></script>

	<!-- <script src="scripts/react/results-table.jsx" type="text/babel"></script> -->

	<script type="text/babel">

		var ResultsTableRow = React.createClass({
			render: function() {
				return (
					<tr>
						<td className="team-a">{ this.props.teamA.name }</td>
						<td className="score"><span>{ this.props.teamA.score }</span> - <span>{ this.props.teamB.score }</span></td>
						<td className="team-b">{ this.props.teamB.name }</td>
						<td className="report">{ this.props.fullTime }</td>
					</tr>
				)
			}
		});

		var ResultsTable = React.createClass({
			render: function() {
				var i = 0;
				return (
					<table className="results">
						<tbody>
							{ this.props.results.map(function(result) {
								return (
									<ResultsTableRow
										key={ i++ }
										teamA={{ name: result.teamA, score: result.teamA_Goals }}
										teamB={{ name: result.teamB, score: result.teamB_Goals }}
										fullTime={ result.fullTime ? "Full time" : "Still to play" }
									/>
								);
							}) }
						</tbody>
					</table>
				)
			}
		});

		var LeagueTable = React.createClass({
			render: function() {
				var i = 0;
				return <table className="league-table" id="large-league-table">
					<thead>
						<tr>
							<th>></th>
							<th>Position</th>
							<th>Team</th>
							<th>P</th>
							<th>W</th>
							<th>D</th>
							<th>L</th>
							<th>F</th>
							<th>A</th>
							<th>GD</th>
							<th>Pts</th>
							<th>Last 5 games</th>
							<th>Report</th>
						</tr>
					</thead>
					<tbody>
						{ this.props.teamsStats.map(function(teamStats) {
							return <LeagueTableRow
								key={ i++ }
								position={ i }
								teamStats={ teamStats }
							/>
						}) }
					</tbody>
				</table>
			}
		});

		var LeagueTableRow = React.createClass({
			render: function() {
				return <tr>
					<td></td>
					<td className="centered position"><div className="arrow-up" /></td>
					<td className="team">{ this.props.teamStats.name }</td>
					<td className="centered played">{ this.props.teamStats.played }</td>
					<td className="centered won">{ this.props.teamStats.won }</td>
					<td className="centered drawn">{ this.props.teamStats.drawn }</td>
					<td className="centered lost">{ this.props.teamStats.lost }</td>
					<td className="centered goals-for">{ this.props.teamStats.goalsFor }</td>
					<td className="centered goals-against">{ this.props.teamStats.goalsAgainst }</td>
					<td className="centered goal-diff">{ this.props.teamStats.goalDiff }</td>
					<td className="centered points">{ this.props.teamStats.points }</td>
					<td className="centered last-five-games"></td>
					<td className="centered report"></td>
				</tr>
			}
		});

		$(document).ready(function() {


			$.ajax({
				url: "/table",
				success: function(data) {
					var results = JSON.parse(data);
					ReactDOM.render(
						<LeagueTable teamsStats={ results } />,
						document.getElementById('large-league-table')
					);

				}
			});

			$.ajax({
				url: "/matches",
				success: function(data) {
					var results = JSON.parse(data);
					ReactDOM.render(
						<ResultsTable results={ results }/>,
						document.getElementById('results')
					);
					
				}
			});
		});
	</script>
</head>
<body>

	<h1>Table</h1>

	<div class="league-table" id="large-league-table">
	</div>

	<h1>Results</h1>

	<div class="results" id="results">
	</div>

</body>
</html>